<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœåŠ¡åˆåŒç®¡ç† - å•†æˆ·ç®¡ç†åå°</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <header>
        <div class="header-title">å•†æˆ·ç®¡ç†åå°</div>
        <nav>
            <span class="user-icon">ğŸ‘¤</span>
            <a href="#" class="logout-link">é€€å‡ºç™»å½•</a>
        </nav>
    </header>

    <div class="container">
        <div id="sidebar-container"></div>

        <div class="main">
            <h2>æœåŠ¡åˆåŒç®¡ç†</h2>

            <div class="filter-section">
                <div class="filter-group">
                    <input type="text" id="searchContract" placeholder="è¾“å…¥æœåŠ¡å•†åç§° / æœåŠ¡åç§° / åœ°åŒº">
                    <button class="btn btn-search" onclick="queryContract()">æŸ¥è¯¢åˆåŒ</button>
                    <button class="btn btn-add" onclick="openContractModal('new')">+ æ–°å»ºåˆåŒ</button>
                </div>
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th>åˆåŒç¼–å·</th>
                        <th>æœåŠ¡å•†åç§°</th>
                        <th>æœåŠ¡åç§°</th>
                        <th>æœåŠ¡åœ°åŒº</th>
                        <th>æœåŠ¡æœŸé™</th>
                        <th>çŠ¶æ€</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>CT2025001</td>
                        <td>ä¼˜å“æœåŠ¡æœ‰é™å…¬å¸</td>
                        <td>å®¶ç”µç»´ä¿®</td>
                        <td>ä¸Šæµ·</td>
                        <td>2025-01-01 è‡³ 2025-12-31</td>
                        <td><span class="status active">ç”Ÿæ•ˆä¸­</span></td>
                        <td>
                            <button class="btn btn-delist" onclick="pauseContract(this)">æš‚åœ</button>
                            <button class="btn btn-delete" onclick="cancelContract(this)">å–æ¶ˆ</button>
                        </td>
                    </tr>
                    <tr>
                        <td>CT2025002</td>
                        <td>æ™ºè¯šç§‘æŠ€æœåŠ¡</td>
                        <td>ç”µå­å®‰è£…</td>
                        <td>å¹¿å·</td>
                        <td>2025-03-01 è‡³ 2026-03-01</td>
                        <td><span class="status pending">æš‚åœ</span></td>
                        <td>
                            <button class="btn btn-accept" onclick="resumeContract(this)">æ¢å¤</button>
                            <button class="btn btn-delete" onclick="cancelContract(this)">å–æ¶ˆ</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- æ–°å»º/ç¼–è¾‘åˆåŒå¼¹çª— -->
    <div class="modal-overlay" id="contractModal" style="display:none;">
        <div class="modal-content">
            <h3 id="contractModalTitle">æ–°å»ºæœåŠ¡åˆåŒ</h3>
            <div class="form-container">
                <div class="form-group"><label>æœåŠ¡å•†åç§°ï¼š</label><input type="text" id="contractProvider" placeholder="è¯·è¾“å…¥æˆ–é€‰æ‹©æœåŠ¡å•†"></div>
                <div class="form-group"><label>æœåŠ¡åç§°ï¼š</label><input type="text" id="contractService" placeholder="è¯·è¾“å…¥æœåŠ¡åç§°"></div>
                <div class="form-group"><label>æœåŠ¡åœ°åŒºï¼š</label><input type="text" id="contractArea" placeholder="è¯·è¾“å…¥æœåŠ¡åœ°åŒº"></div>
                <div class="form-group"><label>æœåŠ¡æœŸé™ï¼š</label><input type="text" id="contractDuration" placeholder="å¦‚ï¼š2025-01-01 è‡³ 2025-12-31"></div>
                <div class="form-group"><label>åˆåŒæ¡æ¬¾ï¼š</label><textarea id="contractTerms" rows="5" placeholder="è¯·è¾“å…¥åˆåŒæ¡æ¬¾è¯¦æƒ…"></textarea></div>
                <div class="form-actions">
                    <button class="btn btn-submit" onclick="saveContract()">ä¿å­˜åˆåŒ</button>
                    <button class="btn btn-cancel" onclick="closeModal('contractModal')">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../script.js"></script>
    <script>
        fetch('../../sidebar.html')
            .then(res => res.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            });

        function queryContract() {
            const keyword = document.getElementById('searchContract').value.trim();
            if (!keyword) return alert('è¯·è¾“å…¥æŸ¥è¯¢æ¡ä»¶');
            alert('æ¨¡æ‹ŸæŸ¥è¯¢åˆåŒ: ' + keyword);
        }

        function openContractModal(type) {
            document.getElementById('contractModal').style.display = 'flex';
            document.getElementById('contractModalTitle').textContent = type === 'new' ? 'æ–°å»ºæœåŠ¡åˆåŒ' : 'ä¿®æ”¹æœåŠ¡åˆåŒ';
            document.querySelectorAll('#contractModal input, #contractModal textarea').forEach(el => el.value = '');
        }

        function saveContract() {
            const provider = document.getElementById('contractProvider').value;
            if (!provider) return alert('è¯·å¡«å†™å¿…å¡«ä¿¡æ¯');
            alert('åˆåŒä¿å­˜æˆåŠŸï¼');
            closeModal('contractModal');
        }

        function pauseContract(btn) {
            if (!confirm('ç¡®å®šè¦æš‚åœè¯¥åˆåŒå—ï¼Ÿ')) return;
            const row = btn.closest('tr');
            row.querySelector('.status').textContent = 'æš‚åœ';
            row.querySelector('.status').className = 'status pending';
            btn.outerHTML = '<button class="btn btn-accept" onclick="resumeContract(this)">æ¢å¤</button>';
        }

        function resumeContract(btn) {
            if (!confirm('ç¡®å®šè¦æ¢å¤è¯¥åˆåŒå—ï¼Ÿ')) return;
            const row = btn.closest('tr');
            row.querySelector('.status').textContent = 'ç”Ÿæ•ˆä¸­';
            row.querySelector('.status').className = 'status active';
            btn.outerHTML = '<button class="btn btn-delist" onclick="pauseContract(this)">æš‚åœ</button>';
        }

        function cancelContract(btn) {
            if (!confirm('ç¡®å®šè¦å–æ¶ˆè¯¥åˆåŒå—ï¼Ÿ')) return;
            btn.closest('tr').remove();
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        document.addEventListener('click', e => {
            if (e.target.classList.contains('modal-overlay')) e.target.style.display = 'none';
        });
    </script>
</body>
</html>
