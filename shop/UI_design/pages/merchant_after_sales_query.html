<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å”®åæŸ¥è¯¢ - å•†æˆ·ç®¡ç†åå°</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <header>
    <div class="header-title">å•†æˆ·ç®¡ç†åå°</div>
    <nav>
      <span class="user-icon">ğŸ‘¤</span>
      <a href="#" class="logout-link">é€€å‡ºç™»å½•</a>
    </nav>
  </header>

  <div class="container">
    <div id="sidebar-container"></div>

    <div class="main">
      <h2>å”®åæŸ¥è¯¢</h2>

      <div class="filter-section">
        <div class="filter-group">
          <input type="text" id="searchAftersales" placeholder="è¾“å…¥æ‰‹æœºå· / è®¢å•å· / å”®åå•å· / å•†å“ / çŠ¶æ€ / åœ°åŒº">
          <button class="btn btn-search" onclick="queryAftersales()">æŸ¥è¯¢</button>
        </div>
      </div>

      <table class="data-table">
        <thead>
          <tr>
            <th>å”®åå•å·</th>
            <th>å•†å“</th>
            <th>æ—¶é—´</th>
            <th>é¡¾å®¢</th>
            <th>åœ°åŒº</th>
            <th>çŠ¶æ€</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>AS2025001</td>
            <td>æ™ºèƒ½æ‰‹æœº</td>
            <td>2025-10-20</td>
            <td>å¼ ä¸‰</td>
            <td>ä¸Šæµ·</td>
            <td><span class="status pending">å¾…å®¡æ ¸</span></td>
            <td>
              <button class="btn btn-view" onclick="openReviewModal('AS2025001')">å®¡æ ¸</button>
              <button class="btn btn-delete" onclick="cancelAfterSales(this)">å–æ¶ˆ</button>
            </td>
          </tr>
          <tr>
            <td>AS2025002</td>
            <td>ç¬”è®°æœ¬ç”µè„‘</td>
            <td>2025-10-22</td>
            <td>æå››</td>
            <td>å¹¿å·</td>
            <td><span class="status approved">å·²å®¡æ ¸</span></td>
            <td>
              <button class="btn btn-view" onclick="openReviewModal('AS2025002')">å®¡æ ¸</button>
              <button class="btn btn-delete" onclick="cancelAfterSales(this)">å–æ¶ˆ</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- å®¡æ ¸å¼¹çª— -->
  <div class="modal-overlay" id="reviewModal" style="display:none;">
    <div class="modal-content">
      <h3>å®¡æ ¸å”®åç”³è¯·</h3>
      <div class="form-group">
        <label>å”®åå•å·ï¼š</label>
        <input type="text" id="reviewId" readonly>
      </div>
      <div class="form-group">
        <label>å®¡æ ¸ç»“æœï¼š</label>
        <select id="reviewResult">
          <option value="agree">åŒæ„</option>
          <option value="disagree">ä¸åŒæ„</option>
        </select>
      </div>
      <div class="form-group">
        <label>å®¡æ ¸è¯´æ˜ï¼š</label>
        <textarea id="reviewNote" rows="4"></textarea>
      </div>
      <div class="form-actions">
        <button class="btn btn-submit" onclick="submitReview()">æäº¤</button>
        <button class="btn btn-cancel" onclick="closeModal('reviewModal')">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <script src="../script.js"></script>
  <script>
    fetch('../sidebar.html')
      .then(r => r.text())
      .then(html => {
        document.getElementById('sidebar-container').innerHTML = html;
        const menu = document.querySelector('a[onclick*="afterSalesMenu"]');
        if (menu) {
          menu.classList.add('active');
          toggleMenu('afterSalesMenu');
        }
      });

    function openReviewModal(asId) {
      document.getElementById('reviewModal').style.display = 'flex';
      document.getElementById('reviewId').value = asId;
    }

    function closeModal(id) {
      document.getElementById(id).style.display = 'none';
    }

    function submitReview() {
      const result = document.getElementById('reviewResult').value;
      const note = document.getElementById('reviewNote').value;
      alert(`å®¡æ ¸æäº¤æˆåŠŸ\nç»“æœ: ${result === 'agree' ? 'åŒæ„' : 'ä¸åŒæ„'}\nè¯´æ˜: ${note}`);
      closeModal('reviewModal');
    }

    function cancelAfterSales(btn) {
      if (confirm('ç¡®å®šè¦å–æ¶ˆè¯¥å”®åå—ï¼Ÿ')) {
        btn.closest('tr').remove();
        alert('å”®åå·²å–æ¶ˆ');
      }
    }

    function queryAftersales() {
      const keyword = document.getElementById('searchAftersales').value;
      alert('æ¨¡æ‹ŸæŸ¥è¯¢å”®å: ' + keyword);
    }
  </script>
</body>
</html>
