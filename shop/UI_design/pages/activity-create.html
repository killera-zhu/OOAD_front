<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>新增活动 - 商户管理后台</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>
  <header>
    <div class="header-title">商户管理后台</div>
    <nav>
      <span class="user-icon">👤</span>
      <a href="#" class="logout-link">退出登录</a>
    </nav>
  </header>

  <div class="container">
    <!-- 引入侧边栏 -->
    <div id="sidebar-container"></div>

    <div class="main">
      <!-- 面包屑导航 -->
      <div class="breadcrumbs" style="margin-bottom: 20px; font-size: 14px; color: #555;">
        <a href="../index.html" style="color: #555; text-decoration: none;">首页</a>
        <span style="margin: 0 8px;">/</span>
        <a href="activity-list.html" style="color: #555; text-decoration: none;">活动管理</a>
        <span style="margin: 0 8px;">/</span>
        <span>新增活动</span>
      </div>

      <h2>新增活动</h2>
      <p style="margin-bottom: 25px; color: #555;">创建新的促销活动或团购活动，吸引更多客户</p>

      <!-- 活动类型选择 -->
      <div class="card" style="width: 100%; text-align: left; padding: 20px; margin: 0 0 20px 0;">
        <h3 style="margin-top: 0; color: #333; font-size: 18px;">选择活动类型</h3>
        <div style="display: flex; gap: 20px; margin-top: 15px;">
          <div style="border: 2px solid #1976d2; background-color: #e3f2fd; padding: 15px; border-radius: 6px; flex: 1; cursor: pointer;" id="promotionCard">
            <input type="radio" name="activityType" id="promotion" checked style="margin-right: 8px;">
            <label for="promotion" style="cursor: pointer; font-weight: 500;">优惠活动</label>
            <p style="margin: 8px 0 0 20px; font-size: 14px; color: #555;">创建折扣、满减等优惠活动，吸引客户购买商品</p>
          </div>
          
          <div style="border: 2px solid #ddd; padding: 15px; border-radius: 6px; flex: 1; cursor: pointer;" id="groupBuyCard">
            <input type="radio" name="activityType" id="groupBuy" style="margin-right: 8px;">
            <label for="groupBuy" style="cursor: pointer; font-weight: 500;">团购活动</label>
            <p style="margin: 8px 0 0 20px; font-size: 14px; color: #555;">创建团购活动，设置成团条件和团购价格，促进销量增长</p>
          </div>
        </div>
      </div>

      <!-- 活动表单 -->
      <div class="form-container">
        <form id="activityForm">
          <!-- 基本信息 -->
          <div class="detail-section">
            <h3>基本信息</h3>
            <div class="form-group">
              <label for="activityName">活动名称 <span style="color: #ea4335;">*</span></label>
              <input type="text" id="activityName" name="activityName" required placeholder="请输入活动名称">
              <p style="margin: 5px 0 0 0; font-size: 12px; color: #888;">请输入简洁明了的活动名称，不超过30个字符</p>
            </div>
            
            <div class="form-group">
              <label for="activityDesc">活动描述</label>
              <textarea id="activityDesc" name="activityDesc" rows="3" placeholder="请输入活动描述"></textarea>
            </div>
          </div>

          <!-- 活动规则 -->
          <div class="detail-section">
            <h3>活动规则</h3>
            <div style="display: flex; flex-wrap: wrap; gap: 20px;">
              <div class="form-group" style="flex: 1; min-width: 250px;">
                <label for="startDate">开始时间 <span style="color: #ea4335;">*</span></label>
                <input type="datetime-local" id="startDate" name="startDate" required>
              </div>
              
              <div class="form-group" style="flex: 1; min-width: 250px;">
                <label for="endDate">结束时间 <span style="color: #ea4335;">*</span></label>
                <input type="datetime-local" id="endDate" name="endDate" required>
              </div>
              
              <div class="form-group" style="flex: 1; min-width: 250px;">
                <label for="discountRatio">折扣比例 (%) <span style="color: #ea4335;">*</span></label>
                <input type="number" id="discountRatio" name="discountRatio" min="1" max="99" required placeholder="请输入折扣比例">
              </div>
              
              <!-- 团购特有字段 -->
              <div id="groupBuyFields" class="form-group" style="flex: 1; min-width: 250px; display: none;">
                <label for="groupSize">成团人数 <span style="color: #ea4335;">*</span></label>
                <input type="number" id="groupSize" name="groupSize" min="2" placeholder="请输入成团人数">
              </div>
            </div>
          </div>

          <!-- 参与商品 -->
          <div class="detail-section">
            <h3>参与商品</h3>
            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px;">
              <button type="button" class="btn btn-add" style="display: inline-flex; align-items: center;">
                <i class="fa fa-plus mr-2"></i> 添加商品
              </button>
              
              <div style="margin-top: 15px; max-height: 200px; overflow-y: auto;">
                <!-- 示例商品 -->
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px; border-bottom: 1px solid #f0f0f0;">
                  <div style="display: flex; align-items: center;">
                    <img src="https://picsum.photos/id/26/80/80" alt="商品图片" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">
                    <div style="margin-left: 10px;">
                      <p style="margin: 0; font-size: 14px; font-weight: 500;">示例商品名称</p>
                      <p style="margin: 5px 0 0 0; font-size: 12px; color: #888;">原价: ¥99.00</p>
                    </div>
                  </div>
                  <button type="button" style="border: none; background: none; color: #ea4335; cursor: pointer;">
                    <i class="fa fa-times"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- 提交按钮 -->
          <div class="form-actions">
            <a href="activity-list.html" class="btn btn-back">返回</a>
            <button type="submit" class="btn btn-submit" style="margin-left: 10px;">提交申请</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- 成功提示模态框 -->
  <div id="successModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 100;">
    <div style="background: white; width: 350px; padding: 25px; border-radius: 6px; text-align: center;">
      <div style="width: 60px; height: 60px; background: #e8f5e9; border-radius: 50%; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
        <i class="fa fa-check text-2xl" style="color: #34a853;"></i>
      </div>
      <h3 style="color: #333; margin: 15px 0 10px 0;">提交成功</h3>
      <p style="color: #666; margin: 0 0 20px 0; font-size: 14px;">您的活动申请已提交，等待审核通过后即可生效</p>
      <button id="closeModal" class="btn btn-submit" style="width: 100%;">确定</button>
    </div>
  </div>

  <script src="../script.js"></script>
  <script>
    // 加载侧边栏并激活当前菜单
    fetch('../sidebar.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('sidebar-container').innerHTML = data;
        document.querySelector('a[onclick="toggleMenu(\'activityMenu\')"]').classList.add('active');
        toggleMenu('activityMenu');
      });

    // 活动类型切换逻辑
    const promotionRadio = document.getElementById('promotion');
    const groupBuyRadio = document.getElementById('groupBuy');
    const promotionCard = document.getElementById('promotionCard');
    const groupBuyCard = document.getElementById('groupBuyCard');
    const groupBuyFields = document.getElementById('groupBuyFields');

    function updateActivityTypeStyle() {
      if (promotionRadio.checked) {
        promotionCard.style.borderColor = '#1976d2';
        promotionCard.style.backgroundColor = '#e3f2fd';
        groupBuyCard.style.borderColor = '#ddd';
        groupBuyCard.style.backgroundColor = 'transparent';
        groupBuyFields.style.display = 'none';
        groupBuyFields.querySelector('input').required = false;
      } else {
        promotionCard.style.borderColor = '#ddd';
        promotionCard.style.backgroundColor = 'transparent';
        groupBuyCard.style.borderColor = '#1976d2';
        groupBuyCard.style.backgroundColor = '#e3f2fd';
        groupBuyFields.style.display = 'block';
        groupBuyFields.querySelector('input').required = true;
      }
    }

    promotionRadio.addEventListener('change', updateActivityTypeStyle);
    groupBuyRadio.addEventListener('change', updateActivityTypeStyle);
    promotionCard.addEventListener('click', () => promotionRadio.checked = true && updateActivityTypeStyle());
    groupBuyCard.addEventListener('click', () => groupBuyRadio.checked = true && updateActivityTypeStyle());

    // 表单提交处理
    const activityForm = document.getElementById('activityForm');
    const successModal = document.getElementById('successModal');
    const closeModal = document.getElementById('closeModal');
    
    activityForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // 表单验证
      const activityName = document.getElementById('activityName').value;
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const discountRatio = document.getElementById('discountRatio').value;
      
      if (!activityName || !startDate || !endDate || !discountRatio) {
        alert('请填写必填字段');
        return;
      }
      
      if (new Date(startDate) >= new Date(endDate)) {
        alert('开始时间必须早于结束时间');
        return;
      }
      
      if (groupBuyRadio.checked && !document.getElementById('groupSize').value) {
        alert('请填写成团人数');
        return;
      }
      
      // 显示成功模态框
      successModal.style.display = 'flex';
    });
    
    // 关闭模态框
    closeModal.addEventListener('click', function() {
      successModal.style.display = 'none';
      activityForm.reset();
      promotionRadio.checked = true;
      updateActivityTypeStyle();
    });
  </script>
</body>
</html>